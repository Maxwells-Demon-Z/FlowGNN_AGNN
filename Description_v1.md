
# TrackGNN 

## Algorithm of TrackGNN 

Given node features and directed adjacent list of one graph which is generated by colliders, the TrackGNN algorithm can figure out which edges in the adjacent list are real, and which edges are not. 

For one graph $G(V,E)$, suppose the input feature and the node embedding of node $v$ are $\mathbf{x}_v$ and $\mathbf{h}_v$, the attention of directed edge $(src, dst)$ is $e_{(src,dst)}$, the input and output messages of node $v$ are $\mathbf{mi}_v$ and $\mathbf{mo}_v$, and the sets of source and target nodes of node $v$ are $SRC(v)$ and $DST(v)$. 

The pseudo codes of TrackGNN can be represented as  
$\mathbf{h}_v^0=MLP_{input}(\mathbf{x}_v),\ \forall v\in V$  
$\mathbf{for}\ k=0...(K-1)$  
$\ \ \ \ e_{(src,dst)}=MLP_{edge}\Big(CONCAT(\mathbf{h}_{src}^k,\mathbf{h}_{dst}^k)\Big),\ \forall(src,dst)\in E$  
$\ \ \ \ \mathbf{mi}_v=\Large\sum\normalsize_{u\in SRC(v)}\ \big(e_{(u,v)}\mathbf{h}_u^k\big),\ \forall v\in V$  
$\ \ \ \ \mathbf{mo}_v=\Large\sum\normalsize_{v\in DST(u)}\ \big(e_{(u,v)}\mathbf{h}_v^k\big),\ \forall v\in V$  
$\ \ \ \ \mathbf{h}_v^{(k+1)}=\mathbf{h}_v^k+MLP_{node}\Big(CONCAT(\mathbf{mi}_v,\mathbf{mo}_v,\mathbf{h}_v^k)\Big),\ \forall v\in V$  
$e_{(src,dst)}=MLP_{edge}\Big(CONCAT(\mathbf{h}_{src}^K,\mathbf{h}_{dst}^K)\Big),\ \forall(src,dst)\in E$  

Suppose the dimensions of input features and node embeddings are $m$ and $n$. Thus, the input and the output dimensions of $MLP_{input}$, $MLP_{edge}$, and $MLP_{node}$ are $m\rightarrow n$, $2n\rightarrow 1$, and $3n\rightarrow n$. 

In this case, the structures of these three MLPs are  
$MLP_{input}$: $Linear(5)\rightarrow Act(tanh)$  
$MLP_{edge}$: $Linear(128)\rightarrow Act(tanh)\rightarrow Linear(64)\rightarrow Act(tanh)\rightarrow Linear(64)\rightarrow Act(tanh)\rightarrow Linear(1)\rightarrow Act(tanh)\rightarrow $  

## d




